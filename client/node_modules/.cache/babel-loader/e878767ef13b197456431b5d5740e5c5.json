{"ast":null,"code":"import _objectSpread from \"C:\\\\Users\\\\morga\\\\Desktop\\\\Webutvikling\\\\Leaflet_Map\\\\client\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"C:\\\\Users\\\\morga\\\\Desktop\\\\Webutvikling\\\\Leaflet_Map\\\\client\\\\src\\\\App.js\";\nimport React from 'react';\nimport Joi from 'joi';\nimport logo from \"./logo.svg\";\nimport L from 'leaflet';\nimport './App.css';\nimport { Map, TileLayer, Marker, Popup } from 'react-leaflet';\nimport { Card, Button, CardTitle, CardText, Form, FormGroup, Label, Input } from 'reactstrap';\nlet myIcon = L.icon({\n  iconUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=',\n  iconSize: [25, 41],\n  iconAnchor: [12.5, 41],\n  popupAnchor: [0, -41]\n});\nconst schema = Joi.object().keys({\n  name: Joi.string().regex(/^[A-zÀ-ú -_]{1,70}$/).min(2).max(30).required(),\n  message: Joi.string().min(1).max(300).required()\n});\nconst API_URL = window.location.hostname == 'localhost' ? 'http://localhost:5000/api/v1/messages' : 'production-url-her'; //-----------------------APP----------------------------------//\n\nclass App extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      location: {\n        lat: 51.505,\n        lng: -0.09\n      },\n      haveUserLocation: false,\n      zoom: 3,\n      userMessage: {\n        name: '',\n        message: ''\n      },\n      sendingMessage: false,\n      sentMessage: false\n    };\n\n    this.formIsValid = () => {\n      const userMessage = {\n        name: this.state.userMessage.name,\n        message: this.state.userMessage.message\n      };\n      const result = Joi.validate(userMessage, schema);\n      return !result.error && this.state.haveUserLocation ? true : false;\n    };\n\n    this.formSubmitted = event => {\n      event.preventDefault();\n\n      if (this.formIsValid()) {\n        this.setState({\n          sendingMessage: true\n        });\n        fetch(API_URL, {\n          method: 'POST',\n          headers: {\n            'content-type': 'application/json'\n          },\n          body: JSON.stringify({\n            name: this.state.userMessage.name,\n            message: this.state.userMessage.message,\n            latitude: this.state.location.lat,\n            longitude: this.state.location.lng\n          })\n        }).then(res => res.json()).then(message => {\n          console.log(message);\n          setTimeout(() => {\n            this.setState({\n              sendingMessage: false,\n              sentMessage: true\n            });\n          }, 1000);\n        });\n      }\n    };\n\n    this.valueChanged = event => {\n      const _event$target = event.target,\n            name = _event$target.name,\n            value = _event$target.value;\n      this.setState(previousState => ({\n        userMessage: _objectSpread({}, previousState.userMessage, {\n          [name]: value\n        })\n      }));\n    };\n  }\n\n  componentDidMount() {\n    navigator.geolocation.getCurrentPosition(position => {\n      this.setState({\n        location: {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        },\n        haveUserLocation: true,\n        zoom: 13\n      });\n    }, () => {\n      console.log('No Location given');\n      fetch('https://ipapi.co/json') //turning response into json\n      .then(res => res.json()).then(location => {\n        this.setState({\n          location: {\n            lat: location.latitude,\n            lng: location.longitude\n          },\n          haveUserLocation: true,\n          zoom: 13\n        });\n      });\n    });\n  }\n\n  render() {\n    const position = [this.state.location.lat, this.state.location.lng];\n    return React.createElement(\"div\", {\n      className: \"map\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(Map, {\n      className: \"map\",\n      center: position,\n      zoom: this.state.zoom,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(TileLayer, {\n      attribution: \"&copy <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",\n      url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }), this.state.haveUserLocation ? React.createElement(Marker, {\n      position: position,\n      icon: myIcon,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, React.createElement(Popup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, \"A pretty CSS3 popup. \", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }), \" DU her her\")) : ''), React.createElement(Card, {\n      body: true,\n      className: \"message-form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(CardTitle, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, \"Finn hverandre!\"), React.createElement(CardText, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, \"Skriv en melding med din posisjon\"), !this.state.sendingMessage && !this.state.sentMessage ? React.createElement(Form, {\n      onSubmit: this.formSubmitted,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(Label, {\n      for: \"name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, \"Navn\"), React.createElement(Input, {\n      onChange: this.valueChanged,\n      type: \"text\",\n      name: \"name\",\n      id: \"name\",\n      placeholder: \"Skriv inn ditt navn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    })), React.createElement(FormGroup, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(Label, {\n      for: \"message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"Melding\"), React.createElement(Input, {\n      onChange: this.valueChanged,\n      type: \"textarea\",\n      name: \"message\",\n      id: \"message\",\n      placeholder: \"Din melding\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    })), React.createElement(Button, {\n      type: \"submit\",\n      color: \"info\",\n      disabled: !this.formIsValid(),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, \"Send\")) : this.state.sendingMessage ? React.createElement(\"video\", {\n      autoplay: true,\n      loop: true,\n      src: \"https://media.giphy.com/media/BCIRKxED2Y2JO/giphy.mp4\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168\n      },\n      __self: this\n    }) : React.createElement(CardText, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, \"Thanks for submitting a message!\")));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:\\Users\\morga\\Desktop\\Webutvikling\\Leaflet_Map\\client\\src\\App.js"],"names":["React","Joi","L","Map","TileLayer","Marker","Popup","Card","Button","CardTitle","CardText","Form","FormGroup","Label","Input","myIcon","icon","iconUrl","iconSize","iconAnchor","popupAnchor","schema","object","keys","name","string","regex","min","max","required","message","API_URL","window","location","hostname","App","Component","state","lat","lng","haveUserLocation","zoom","userMessage","sendingMessage","sentMessage","formIsValid","result","validate","error","formSubmitted","event","preventDefault","setState","fetch","method","headers","body","JSON","stringify","latitude","longitude","then","res","json","console","log","setTimeout","valueChanged","target","value","previousState","componentDidMount","navigator","geolocation","getCurrentPosition","position","coords","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Joi from 'joi';\nimport logo from './logo.svg';\nimport L from 'leaflet';\nimport './App.css';\nimport { Map, TileLayer, Marker, Popup } from 'react-leaflet';\nimport { Card, Button, CardTitle, CardText, Form, FormGroup, Label, Input } from 'reactstrap';\n\n\nlet myIcon = L.icon({\n    iconUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=',\n    iconSize: [25, 41],\n    iconAnchor: [12.5, 41],\n    popupAnchor: [0, -41],\n\n});\n\nconst schema = Joi.object().keys({\n  name: Joi.string().regex(/^[A-zÀ-ú -_]{1,70}$/).min(2).max(30).required(),\n  message: Joi.string().min(1).max(300).required()\n});\n\nconst API_URL = window.location.hostname == 'localhost' ? 'http://localhost:5000/api/v1/messages' : 'production-url-her';\n//-----------------------APP----------------------------------//\nclass App extends React.Component {\n  state = {\n    location: {\n      lat: 51.505,\n      lng: -0.09,\n    },\n    haveUserLocation: false,\n    zoom: 3,\n    userMessage: {\n      name: '',\n      message: ''\n    },\n    sendingMessage : false,\n    sentMessage: false\n  }\n  \n  componentDidMount(){\n    navigator.geolocation.getCurrentPosition((position)=> {\n                 this.setState({\n                   location: {\n                     lat: position.coords.latitude,\n                     lng: position.coords.longitude\n                   },\n                   haveUserLocation: true,\n                   zoom: 13\n                 });\n            },() =>{\n              console.log('No Location given');\n              fetch('https://ipapi.co/json')\n              //turning response into json\n              .then(res => res.json())\n              .then(location => {\n                this.setState({\n                  location: {\n                    lat: location.latitude,\n                    lng: location.longitude\n                  },\n                  haveUserLocation: true,\n                  zoom: 13\n                });\n              });\n            });\n  }\n  formIsValid = () =>{\n    const userMessage = \n    {\n      name: this.state.userMessage.name,\n      message: this.state.userMessage.message\n    };\n    const result = Joi.validate(userMessage, schema);\n\n    return !result.error && this.state.haveUserLocation ? true : false;\n  }\n\n  formSubmitted = event =>{\n    event.preventDefault()\n    if(this.formIsValid()){\n      this.setState({\n        sendingMessage : true\n      });\n      fetch(API_URL, {\n        method: 'POST',\n        headers: {\n          'content-type' : 'application/json'\n        },\n        body: JSON.stringify({\n          name: this.state.userMessage.name,\n          message: this.state.userMessage.message,\n          latitude : this.state.location.lat,\n          longitude: this.state.location.lng\n        })\n      }).then(res => res.json())\n      .then(message =>{\n        console.log(message);\n        setTimeout(() => {\n            this.setState({\n                sendingMessage : false,\n                sentMessage: true\n            });\n        }, 1000);\n\n      });\n    }\n  };\n\n\n  valueChanged = (event) => {\n    const {name, value} = event.target;\n    this.setState((previousState) => ({\n      userMessage: {\n        ...previousState.userMessage,\n        [name]: value\n      }\n    })); \n  };\n\n  render(){\n  const position = [this.state.location.lat, this.state.location.lng];\n\n  return (\n    <div className=\"map\">\n    <Map className=\"map\" center={position} zoom={this.state.zoom}>\n        <TileLayer\n          attribution='&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        {\n          this.state.haveUserLocation ?\n            <Marker position={position}\n                      icon={myIcon}>\n                                <Popup>\n                                    A pretty CSS3 popup. <br /> DU her her\n                                 </Popup>\n            </Marker> : ''\n        }\n      </Map>\n      <Card body className=\"message-form\">\n        <CardTitle>Finn hverandre!</CardTitle>\n        <CardText>Skriv en melding med din posisjon</CardText>\n        {\n          !this.state.sendingMessage && !this.state.sentMessage ? \n        <Form onSubmit={this.formSubmitted} >\n        <FormGroup>\n          <Label for=\"name\">Navn</Label>\n          <Input\n            onChange={this.valueChanged}\n            type=\"text\"\n            name=\"name\"\n            id=\"name\"\n            placeholder=\"Skriv inn ditt navn\" />\n        </FormGroup>\n        <FormGroup>\n          <Label for=\"message\">Melding</Label>\n          <Input\n            onChange={this.valueChanged}\n            type=\"textarea\"\n            name=\"message\"\n            id=\"message\"\n            placeholder=\"Din melding\" />\n        </FormGroup>\n        <Button type=\"submit\" color=\"info\" disabled={!this.formIsValid()}>Send</Button>\n      </Form> :\n       this.state.sendingMessage ?\n          <video autoplay loop src=\"https://media.giphy.com/media/BCIRKxED2Y2JO/giphy.mp4\"></video>:\n          <CardText>Thanks for submitting a message!</CardText>\n        }\n      </Card>\n      </div>\n        );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}